Running script...
Looking in links: https://download.pytorch.org/whl/cu113/torch_stable.html
Requirement already satisfied: torch==1.10.0+cu113 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (1.10.0+cu113)
Requirement already satisfied: torchvision==0.11.1+cu113 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (0.11.1+cu113)
Requirement already satisfied: typing-extensions in /appl/python/3.7.11/lib/python3.7/site-packages (from torch==1.10.0+cu113) (3.10.0.0)
Requirement already satisfied: pillow!=8.3.0,>=5.3.0 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/Pillow-8.3.1-py3.7-linux-x86_64.egg (from torchvision==0.11.1+cu113) (8.3.1)
Requirement already satisfied: numpy in /appl/numpy/1.21.1-python-3.7.11-openblas-0.3.17/lib/python3.7/site-packages/numpy-1.21.1-py3.7-linux-x86_64.egg (from torchvision==0.11.1+cu113) (1.21.1)
Requirement already satisfied: scikit-image[optional] in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (0.18.3)
Requirement already satisfied: tqdm in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (4.62.3)
Requirement already satisfied: networkx>=2.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2.6.3)
Requirement already satisfied: scipy>=1.0.1 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (1.7.2)
Requirement already satisfied: PyWavelets>=1.1.1 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (1.2.0)
Requirement already satisfied: pillow!=7.1.0,!=7.1.1,>=4.3.0 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/Pillow-8.3.1-py3.7-linux-x86_64.egg (from scikit-image[optional]) (8.3.1)
Requirement already satisfied: imageio>=2.3.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2.12.0)
Requirement already satisfied: tifffile>=2019.7.26 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2021.11.2)
Requirement already satisfied: matplotlib!=3.0.0,>=2.0.0 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/matplotlib-3.4.2-py3.7-linux-x86_64.egg (from scikit-image[optional]) (3.4.2)
Requirement already satisfied: numpy>=1.16.5 in /appl/numpy/1.21.1-python-3.7.11-openblas-0.3.17/lib/python3.7/site-packages/numpy-1.21.1-py3.7-linux-x86_64.egg (from scikit-image[optional]) (1.21.1)
Requirement already satisfied: astropy>=3.1.2 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (4.3.1)
Requirement already satisfied: SimpleITK in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2.1.1)
Requirement already satisfied: dask[array]!=2.17.0,>=1.0.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2021.11.2)
Requirement already satisfied: pooch>=1.3.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (1.5.2)
Requirement already satisfied: pyamg in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (4.1.0)
Requirement already satisfied: cloudpickle>=0.2.1 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2.0.0)
Requirement already satisfied: qtpy in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (1.11.2)
Requirement already satisfied: importlib-metadata in /appl/python/3.7.11/lib/python3.7/site-packages (from astropy>=3.1.2->scikit-image[optional]) (4.6.3)
Requirement already satisfied: pyerfa>=1.7.3 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from astropy>=3.1.2->scikit-image[optional]) (2.0.0.1)
Requirement already satisfied: partd>=0.3.10 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (1.2.0)
Requirement already satisfied: toolz>=0.8.2 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (0.11.2)
Requirement already satisfied: packaging>=20.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (21.3)
Requirement already satisfied: pyyaml in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (6.0)
Requirement already satisfied: fsspec>=0.6.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (2021.11.0)
Collecting pillow!=7.1.0,!=7.1.1,>=4.3.0
  Using cached Pillow-8.4.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.1 MB)
Requirement already satisfied: cycler>=0.10 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/cycler-0.10.0-py3.7.egg (from matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (0.10.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/kiwisolver-1.3.1-py3.7-linux-x86_64.egg (from matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (1.3.1)
Requirement already satisfied: pyparsing>=2.2.1 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/pyparsing-3.0.0b2-py3.7.egg (from matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (3.0.0b2)
Requirement already satisfied: python-dateutil>=2.7 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/python_dateutil-2.8.2-py3.7.egg (from matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (2.8.2)
Requirement already satisfied: six in /appl/python/3.7.11/lib/python3.7/site-packages (from cycler>=0.10->matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (1.16.0)
Requirement already satisfied: locket in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from partd>=0.3.10->dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (0.2.1)
Requirement already satisfied: appdirs in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pooch>=1.3.0->scikit-image[optional]) (1.4.4)
Requirement already satisfied: requests in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pooch>=1.3.0->scikit-image[optional]) (2.26.0)
Requirement already satisfied: typing-extensions>=3.6.4 in /appl/python/3.7.11/lib/python3.7/site-packages (from importlib-metadata->astropy>=3.1.2->scikit-image[optional]) (3.10.0.0)
Requirement already satisfied: zipp>=0.5 in /appl/python/3.7.11/lib/python3.7/site-packages (from importlib-metadata->astropy>=3.1.2->scikit-image[optional]) (3.5.0)
Requirement already satisfied: pytest>=2 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pyamg->scikit-image[optional]) (6.2.5)
Requirement already satisfied: attrs>=19.2.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (21.2.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (1.0.0)
Requirement already satisfied: py>=1.8.2 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (1.11.0)
Requirement already satisfied: iniconfig in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (1.1.1)
Requirement already satisfied: toml in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (0.10.2)
Requirement already satisfied: idna<4,>=2.5 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from requests->pooch>=1.3.0->scikit-image[optional]) (3.3)
Requirement already satisfied: certifi>=2017.4.17 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from requests->pooch>=1.3.0->scikit-image[optional]) (2021.10.8)
Requirement already satisfied: charset-normalizer~=2.0.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from requests->pooch>=1.3.0->scikit-image[optional]) (2.0.7)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from requests->pooch>=1.3.0->scikit-image[optional]) (1.26.7)
Installing collected packages: pillow
Successfully installed pillow-8.4.0
Running project Nepal load_model: True model: save_model/Myanmar-scratch-new.pt
training data: 41510
valid data: 6111
test data: 12445
{'train': 41510, 'val': 6111, 'test': 12445}
[1 0 1 0 0 1 0 0 0 0]
{'train': <torch.utils.data.dataloader.DataLoader object at 0x7f71cfdd6850>, 'val': <torch.utils.data.dataloader.DataLoader object at 0x7f71d2efc690>, 'test': <torch.utils.data.dataloader.DataLoader object at 0x7f71cfdd6990>}
[   50] loss: 10.122
[  100] loss: 9.655
[  150] loss: 9.362
[  200] loss: 9.608
[  250] loss: 9.579
[  300] loss: 9.304
[  350] loss: 9.222
-----GLOBAL ACCURACY-------
{'1010010000': {'num': 3905, 'num_correct': 917}, '1000010000': {'num': 8266, 'num_correct': 5732}, '1000000000': {'num': 113, 'num_correct': 45}, '1011010000': {'num': 111, 'num_correct': 5}, '1100010000': {'num': 50, 'num_correct': 0}}
ID: 1010010000 - Acc: 0.23482714468629962 - Tot: 3905
ID: 1000010000 - Acc: 0.6934430195983547 - Tot: 8266
ID: 1000000000 - Acc: 0.39823008849557523 - Tot: 113
ID: 1011010000 - Acc: 0.04504504504504504 - Tot: 111
ID: 1100010000 - Acc: 0.0 - Tot: 50
TEST Loss: 5.7785 Acc: 0.5386
Completed.
