Running script...
Looking in links: https://download.pytorch.org/whl/cu113/torch_stable.html
Requirement already satisfied: torch==1.10.0+cu113 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (1.10.0+cu113)
Requirement already satisfied: torchvision==0.11.1+cu113 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (0.11.1+cu113)
Requirement already satisfied: typing-extensions in /appl/python/3.7.11/lib/python3.7/site-packages (from torch==1.10.0+cu113) (3.10.0.0)
Requirement already satisfied: numpy in /appl/numpy/1.21.1-python-3.7.11-openblas-0.3.17/lib/python3.7/site-packages/numpy-1.21.1-py3.7-linux-x86_64.egg (from torchvision==0.11.1+cu113) (1.21.1)
Requirement already satisfied: pillow!=8.3.0,>=5.3.0 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/Pillow-8.3.1-py3.7-linux-x86_64.egg (from torchvision==0.11.1+cu113) (8.3.1)
Requirement already satisfied: scikit-image[optional] in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (0.18.3)
Requirement already satisfied: tqdm in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (4.62.3)
Requirement already satisfied: networkx>=2.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2.6.3)
Requirement already satisfied: pillow!=7.1.0,!=7.1.1,>=4.3.0 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/Pillow-8.3.1-py3.7-linux-x86_64.egg (from scikit-image[optional]) (8.3.1)
Requirement already satisfied: imageio>=2.3.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2.12.0)
Requirement already satisfied: PyWavelets>=1.1.1 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (1.2.0)
Requirement already satisfied: matplotlib!=3.0.0,>=2.0.0 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/matplotlib-3.4.2-py3.7-linux-x86_64.egg (from scikit-image[optional]) (3.4.2)
Requirement already satisfied: tifffile>=2019.7.26 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2021.11.2)
Requirement already satisfied: scipy>=1.0.1 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (1.7.2)
Requirement already satisfied: numpy>=1.16.5 in /appl/numpy/1.21.1-python-3.7.11-openblas-0.3.17/lib/python3.7/site-packages/numpy-1.21.1-py3.7-linux-x86_64.egg (from scikit-image[optional]) (1.21.1)
Requirement already satisfied: dask[array]!=2.17.0,>=1.0.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2021.11.2)
Requirement already satisfied: SimpleITK in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2.1.1)
Requirement already satisfied: astropy>=3.1.2 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (4.3.1)
Requirement already satisfied: pooch>=1.3.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (1.5.2)
Requirement already satisfied: pyamg in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (4.1.0)
Requirement already satisfied: cloudpickle>=0.2.1 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (2.0.0)
Requirement already satisfied: qtpy in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from scikit-image[optional]) (1.11.2)
Requirement already satisfied: importlib-metadata in /appl/python/3.7.11/lib/python3.7/site-packages (from astropy>=3.1.2->scikit-image[optional]) (4.6.3)
Requirement already satisfied: pyerfa>=1.7.3 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from astropy>=3.1.2->scikit-image[optional]) (2.0.0.1)
Requirement already satisfied: toolz>=0.8.2 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (0.11.2)
Requirement already satisfied: fsspec>=0.6.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (2021.11.0)
Requirement already satisfied: pyyaml in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (6.0)
Requirement already satisfied: packaging>=20.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (21.3)
Requirement already satisfied: partd>=0.3.10 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (1.2.0)
Collecting pillow!=7.1.0,!=7.1.1,>=4.3.0
  Using cached Pillow-8.4.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.1 MB)
Requirement already satisfied: cycler>=0.10 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/cycler-0.10.0-py3.7.egg (from matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (0.10.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/kiwisolver-1.3.1-py3.7-linux-x86_64.egg (from matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (1.3.1)
Requirement already satisfied: pyparsing>=2.2.1 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/pyparsing-3.0.0b2-py3.7.egg (from matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (3.0.0b2)
Requirement already satisfied: python-dateutil>=2.7 in /appl/matplotlib/3.4.2-numpy-1.21.1-python-3.7.11/lib/python3.7/site-packages/python_dateutil-2.8.2-py3.7.egg (from matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (2.8.2)
Requirement already satisfied: six in /appl/python/3.7.11/lib/python3.7/site-packages (from cycler>=0.10->matplotlib!=3.0.0,>=2.0.0->scikit-image[optional]) (1.16.0)
Requirement already satisfied: locket in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from partd>=0.3.10->dask[array]!=2.17.0,>=1.0.0->scikit-image[optional]) (0.2.1)
Requirement already satisfied: appdirs in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pooch>=1.3.0->scikit-image[optional]) (1.4.4)
Requirement already satisfied: requests in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pooch>=1.3.0->scikit-image[optional]) (2.26.0)
Requirement already satisfied: typing-extensions>=3.6.4 in /appl/python/3.7.11/lib/python3.7/site-packages (from importlib-metadata->astropy>=3.1.2->scikit-image[optional]) (3.10.0.0)
Requirement already satisfied: zipp>=0.5 in /appl/python/3.7.11/lib/python3.7/site-packages (from importlib-metadata->astropy>=3.1.2->scikit-image[optional]) (3.5.0)
Requirement already satisfied: pytest>=2 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pyamg->scikit-image[optional]) (6.2.5)
Requirement already satisfied: py>=1.8.2 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (1.11.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (1.0.0)
Requirement already satisfied: toml in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (0.10.2)
Requirement already satisfied: attrs>=19.2.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (21.2.0)
Requirement already satisfied: iniconfig in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from pytest>=2->pyamg->scikit-image[optional]) (1.1.1)
Requirement already satisfied: certifi>=2017.4.17 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from requests->pooch>=1.3.0->scikit-image[optional]) (2021.10.8)
Requirement already satisfied: idna<4,>=2.5 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from requests->pooch>=1.3.0->scikit-image[optional]) (3.3)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from requests->pooch>=1.3.0->scikit-image[optional]) (1.26.7)
Requirement already satisfied: charset-normalizer~=2.0.0 in /zhome/4a/3/154575/.local/lib/python3.7/site-packages (from requests->pooch>=1.3.0->scikit-image[optional]) (2.0.7)
Installing collected packages: pillow
Successfully installed pillow-8.4.0
Running project Nepal load_model: True model: save_model/Myanmar-scratch-new.pt
training data: 41510
valid data: 6111
test data: 12445
{'train': 41510, 'val': 6111, 'test': 12445}
[1 0 1 0 0 1 0 0 0 0]
{'train': <torch.utils.data.dataloader.DataLoader object at 0x7f9bd0890650>, 'val': <torch.utils.data.dataloader.DataLoader object at 0x7f9bd0890990>, 'test': <torch.utils.data.dataloader.DataLoader object at 0x7f9bd0890a50>}
Epoch 1/10
----------
train Loss: 1.3964 Acc: 0.7607
val Loss: 0.5843 Acc: 0.7991

Epoch 2/10
----------
train Loss: 0.7750 Acc: 0.8035
val Loss: 0.5247 Acc: 0.8144

Epoch 3/10
----------
train Loss: 0.5724 Acc: 0.8084
val Loss: 0.5034 Acc: 0.8207

Epoch 4/10
----------
train Loss: 0.5437 Acc: 0.8110
val Loss: 0.4898 Acc: 0.8254

Epoch 5/10
----------
train Loss: 0.5325 Acc: 0.8132
val Loss: 0.4953 Acc: 0.8246

Epoch 6/10
----------
train Loss: 0.5273 Acc: 0.8164
val Loss: 0.4891 Acc: 0.8269

Epoch 7/10
----------
train Loss: 0.5275 Acc: 0.8152
val Loss: 0.4954 Acc: 0.8244

Epoch 8/10
----------
train Loss: 0.5290 Acc: 0.8129
val Loss: 0.4896 Acc: 0.8259

Epoch 9/10
----------
train Loss: 0.5292 Acc: 0.8137
val Loss: 0.4959 Acc: 0.8234

Epoch 10/10
----------
train Loss: 0.5267 Acc: 0.8131
val Loss: 0.4959 Acc: 0.8236

Training complete in 49m 56s
Best val Acc: 0.826870
[0.760660081907974, 0.799050891834397, 0.8035413153456998, 0.8144329896907216, 0.8084317032040472, 0.8206512845688103, 0.8109853047458444, 0.8253968253968254, 0.8132257287400626, 0.82457862870234, 0.8163575042158516, 0.826869579446899, 0.8152493375090339, 0.8244149893634429, 0.8128884606119008, 0.8258877434135166, 0.8136834497711395, 0.8234331533300605, 0.8131052758371476, 0.8235967926689576]
[   50] loss: 0.714
[  100] loss: 0.646
[  150] loss: 0.691
[  200] loss: 0.731
[  250] loss: 0.710
[  300] loss: 0.723
[  350] loss: 0.713
-----GLOBAL ACCURACY-------
{'1010010000': {'num': 3905, 'num_correct': 2801}, '1000010000': {'num': 8266, 'num_correct': 7484}, '1000000000': {'num': 113, 'num_correct': 0}, '1011010000': {'num': 111, 'num_correct': 0}, '1100010000': {'num': 50, 'num_correct': 0}}
ID: 1010010000 - Acc: 0.7172855313700384 - Tot: 3905
ID: 1000010000 - Acc: 0.9053955964190661 - Tot: 8266
ID: 1000000000 - Acc: 0.0 - Tot: 113
ID: 1011010000 - Acc: 0.0 - Tot: 111
ID: 1100010000 - Acc: 0.0 - Tot: 50
TEST Loss: 0.4571 Acc: 0.8264
Completed.
